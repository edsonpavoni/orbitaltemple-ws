---
import Base from "../layouts/BaseLayout.astro";
import SendNameForm from "../components/NameAscensionForm";
---
<Base title="Send a Name - Orbital Temple">

  <!-- Disable scroll for this page -->
  <style is:global>
    html {
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      overscroll-behavior: none !important;
      -webkit-overflow-scrolling: touch !important;
    }

    body {
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      height: 100% !important;
      top: 0 !important;
      left: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      overscroll-behavior: none !important;
      -webkit-overflow-scrolling: touch !important;
    }

    /* Prevent any scrolling in inputs */
    input, textarea {
      touch-action: manipulation !important;
      -webkit-user-select: text !important;
    }

    /* Prevent zoom on iOS when focusing inputs */
    input, textarea, select {
      font-size: 16px !important; /* Prevents zoom on iOS */
    }

    /* Additional scroll lock */
    #root, #__next, [data-reactroot] {
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      height: 100% !important;
    }
  </style>

  <!-- Additional iOS keyboard fix script -->
  <script is:inline>
    // Aggressive scroll prevention for iOS
    (function() {
      // Cached function for scroll reset to avoid recreation
      var resetScroll = function() {
        window.scrollTo(0, 0);
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
      };

      // Prevent all scrolling
      document.addEventListener('touchmove', function(e) {
        // Allow scrolling only on inputs when keyboard is open
        if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
          e.preventDefault();
        }
      }, { passive: false });

      // Force scroll to top on any scroll attempt
      var scrollTimeout;
      window.addEventListener('scroll', function() {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(resetScroll, 0);
      }, { passive: false });

      // Prevent iOS from scrolling when keyboard appears
      window.addEventListener('resize', resetScroll);

      // Force top position on interval (reduced frequency for better performance)
      setInterval(function() {
        if (window.scrollY > 0 || document.body.scrollTop > 0) {
          resetScroll();
        }
      }, 200); // Reduced from 100ms to 200ms for better performance
    })();
  </script>

  <!-- Fixed Dome at top - animates down during journey -->
  <div id="dome-container" style="position: fixed; top: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 640px; overflow: hidden; z-index: 1; pointer-events: none;">
    <picture>
      <source media="(min-width: 768px)" srcset="/UI/dome_large.webp" />
      <img id="dome-image" src="/UI/dome.webp" alt="Dome" style="position: relative; width: 100%; height: auto; display: block; transform: translateY(-100%); transition: transform 1s ease-out;" />
    </picture>
  </div>

  <!-- Main Content - Component handles its own positioning -->
  <SendNameForm client:only="react" />

</Base>
